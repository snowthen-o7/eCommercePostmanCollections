{
	"info": {
		"_postman_id": "trustpilot-api-20251210",
		"name": "TrustPilot API",
		"description": "# TrustPilot API\n\nAPI endpoints for TrustPilot product reviews integration.\n\n## Quick Start\n\n### 1. Set Environment Variables\n\n| Variable | Required | Description |\n|----------|----------|-------------|\n| `trustpilot_host` | \u2705 | API host (`https://api.trustpilot.com/`) |\n| `trustpilot_api_key` | \u2705 | Your API key |\n| `trustpilot_api_secret` | \u2705 | Your API secret |\n| `trustpilot_username` | \u2705 | TrustPilot account email |\n| `trustpilot_password` | \u2705 | TrustPilot account password |\n| `trustpilot_business_unit_id` | \u2705 | Your Business Unit ID |\n\n### 2. Get Your API Credentials\n\n1. Log in to TrustPilot Business\n2. Go to Integrations \u2192 API\n3. Create an application to get API key and secret\n4. Find your Business Unit ID in the URL or account settings\n\n### 3. Authentication Flow\n\n1. **First**: Run \"Auth Call\" to get an access token\n   - Uses Basic Auth with API key/secret\n   - Submits username/password in body\n   - Returns an access token\n\n2. **Then**: Use the access token for subsequent requests\n   - The token is stored in `trustpilot_access_token`\n   - Used as Bearer token for API calls\n\n\n\n## Variables\n\nThis collection includes pre-defined variables. You can set them in two ways:\n\n**Option 1: Collection Variables (Quick Start)**\n1. Click on the collection name\n2. Go to the \"Variables\" tab\n3. Fill in the \"Current value\" column\n\n**Option 2: Environment Variables (Recommended for multiple stores)**\n1. Import `Ecommerce_APIs.postman_environment.json`\n2. Fill in your values\n3. Select the environment in Postman\n\nEnvironment variables override collection variables, so you can use both.\n\n## Endpoints\n\n| Request | Description |\n|---------|-------------|\n| Auth Call | Get OAuth access token |\n| UpsertProducts | Create or update products |\n\n## API Documentation\n\nhttps://developers.trustpilot.com/\n",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Auth Call",
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "{{trustpilot_api_secret}}",
							"type": "string"
						},
						{
							"key": "username",
							"value": "{{trustpilot_api_key}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "username",
							"value": "{{trustpilot_username}}",
							"type": "text"
						},
						{
							"key": "password",
							"value": "{{trustpilot_password}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{trustpilot_host}}v1/oauth/oauth-business-users-for-applications/accesstoken",
					"host": [
						"{{trustpilot_host}}v1"
					],
					"path": [
						"oauth",
						"oauth-business-users-for-applications",
						"accesstoken"
					]
				}
			},
			"response": [],
			"description": "Authenticates with TrustPilot using OAuth password grant. Returns an access token to use for subsequent API calls. The token is automatically stored in the trustpilot_access_token variable.",
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"// Standard response validation",
							"pm.test(\"Status code is successful\", function () {",
							"    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);",
							"});",
							"",
							"pm.test(\"Response time is acceptable\", function () {",
							"    pm.expect(pm.response.responseTime).to.be.below(5000);",
							"});",
							"",
							"// Parse JSON and extract access token",
							"if (pm.response.headers.get('Content-Type')?.includes('application/json')) {",
							"    pm.test(\"Response is valid JSON\", function () {",
							"        pm.response.to.be.json;",
							"    });",
							"    try {",
							"        const response = pm.response.json();",
							"        if (response.access_token) {",
							"            pm.environment.set('trustpilot_access_token', response.access_token);",
							"            console.log('Access token saved to trustpilot_access_token');",
							"        }",
							"    } catch(e) { }",
							"}"
						]
					}
				}
			]
		},
		{
			"name": "UpsertProducts",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{trustpilot_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "username",
							"value": "{{trustpilot_username}}",
							"type": "text"
						},
						{
							"key": "password",
							"value": "{{trustpilot_password}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{trustpilot_host}}v1/private/business-units/{{trustpilot_business_unit_id}}/products",
					"host": [
						"{{trustpilot_host}}v1"
					],
					"path": [
						"private",
						"business-units",
						"{{trustpilot_business_unit_id}}",
						"products"
					]
				}
			},
			"response": [],
			"description": "Creates or updates products in your TrustPilot business unit. Use this to sync your product catalog for review collection.",
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"// Standard response validation",
							"pm.test(\"Status code is successful\", function () {",
							"    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);",
							"});",
							"",
							"pm.test(\"Response time is acceptable\", function () {",
							"    pm.expect(pm.response.responseTime).to.be.below(5000);",
							"});",
							"",
							"// Parse JSON if available",
							"if (pm.response.headers.get('Content-Type')?.includes('application/json')) {",
							"    pm.test(\"Response is valid JSON\", function () {",
							"        pm.response.to.be.json;",
							"    });",
							"}"
						]
					}
				}
			]
		},
		{
			"name": "GetProducts",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{trustpilot_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "username",
							"value": "{{trustpilot_username}}",
							"type": "text"
						},
						{
							"key": "password",
							"value": "{{trustpilot_password}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{trustpilot_host}}v1/private/business-units/{{trustpilot_business_unit_id}}/products",
					"host": [
						"{{trustpilot_host}}v1"
					],
					"path": [
						"private",
						"business-units",
						"{{trustpilot_business_unit_id}}",
						"products"
					]
				}
			},
			"response": [],
			"description": "Retrieves all products registered in your TrustPilot business unit. Returns product details including SKUs, names, and review statistics.",
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"// Standard response validation",
							"pm.test(\"Status code is successful\", function () {",
							"    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);",
							"});",
							"",
							"pm.test(\"Response time is acceptable\", function () {",
							"    pm.expect(pm.response.responseTime).to.be.below(5000);",
							"});",
							"",
							"// Parse JSON if available",
							"if (pm.response.headers.get('Content-Type')?.includes('application/json')) {",
							"    pm.test(\"Response is valid JSON\", function () {",
							"        pm.response.to.be.json;",
							"    });",
							"}"
						]
					}
				}
			]
		},
		{
			"name": "Get Business Unit",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [{"key": "token", "value": "{{trustpilot_access_token}}", "type": "string"}]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{trustpilot_host}}v1/business-units/{{trustpilot_business_unit_id}}",
					"host": ["{{trustpilot_host}}v1"],
					"path": ["business-units", "{{trustpilot_business_unit_id}}"]
				},
				"description": "Retrieves details about your business unit including name, website, and review statistics."
			},
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"pm.test('Status code is 200', function() { pm.response.to.have.status(200); });",
							"pm.test('Response is JSON', function() { pm.response.to.be.json; });"
						]
					}
				}
			]
		},
		{
			"name": "Get Product Reviews",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [{"key": "token", "value": "{{trustpilot_access_token}}", "type": "string"}]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{trustpilot_host}}v1/private/business-units/{{trustpilot_business_unit_id}}/reviews?perPage=10",
					"host": ["{{trustpilot_host}}v1"],
					"path": ["private", "business-units", "{{trustpilot_business_unit_id}}", "reviews"],
					"query": [{"key": "perPage", "value": "10"}]
				},
				"description": "Retrieves product reviews for your business unit."
			},
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"pm.test('Status code is 200', function() { pm.response.to.have.status(200); });",
							"pm.test('Response is JSON', function() { pm.response.to.be.json; });",
							"try {",
							"    const response = pm.response.json();",
							"    if (response.reviews && response.reviews.length > 0) {",
							"        pm.environment.set('trustpilot_review_id', response.reviews[0].id);",
							"        console.log('Extracted review_id:', response.reviews[0].id);",
							"    }",
							"} catch(e) { }"
						]
					}
				}
			]
		},
		{
			"name": "Get Review by ID",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [{"key": "token", "value": "{{trustpilot_access_token}}", "type": "string"}]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{trustpilot_host}}v1/reviews/{{trustpilot_review_id}}",
					"host": ["{{trustpilot_host}}v1"],
					"path": ["reviews", "{{trustpilot_review_id}}"]
				},
				"description": "Retrieves a single review by its ID."
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							"const reviewId = pm.environment.get('trustpilot_review_id');",
							"if (!reviewId) { console.log('Skipping: trustpilot_review_id not set'); pm.execution.skipRequest(); }"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"pm.test('Status code is 200', function() { pm.response.to.have.status(200); });",
							"pm.test('Response is JSON', function() { pm.response.to.be.json; });"
						]
					}
				}
			]
		},
		{
			"name": "Get Business Unit Stats",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [{"key": "token", "value": "{{trustpilot_access_token}}", "type": "string"}]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{trustpilot_host}}v1/business-units/{{trustpilot_business_unit_id}}/statistics",
					"host": ["{{trustpilot_host}}v1"],
					"path": ["business-units", "{{trustpilot_business_unit_id}}", "statistics"]
				},
				"description": "Retrieves review statistics including star distribution and TrustScore."
			},
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"pm.test('Status code is 200', function() { pm.response.to.have.status(200); });",
							"pm.test('Response is JSON', function() { pm.response.to.be.json; });"
						]
					}
				}
			]
		},
		{
			"name": "Create Service Review Invitation",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [{"key": "token", "value": "{{trustpilot_access_token}}", "type": "string"}]
				},
				"method": "POST",
				"header": [
					{"key": "Content-Type", "value": "application/json", "type": "text"}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"consumerEmail\": \"customer@example.com\",\n  \"consumerName\": \"Test Customer\",\n  \"referenceNumber\": \"ORDER-12345\",\n  \"locale\": \"en-US\"\n}"
				},
				"url": {
					"raw": "{{trustpilot_host}}v1/private/business-units/{{trustpilot_business_unit_id}}/email-invitations",
					"host": ["{{trustpilot_host}}v1"],
					"path": ["private", "business-units", "{{trustpilot_business_unit_id}}", "email-invitations"]
				},
				"description": "Creates an email invitation for a customer to leave a service review. Modify the body with actual customer data."
			},
			"event": [
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							"pm.test('Status code is successful', function() { pm.expect(pm.response.code).to.be.oneOf([200, 201, 202]); });",
							"pm.test('Response is JSON', function() { pm.response.to.be.json; });"
						]
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// ============================================",
					"// SHARED PRE-REQUEST UTILITIES",
					"// ============================================",
					"",
					"// Configuration",
					"const CONFIG = {",
					"    responseTimeThreshold: pm.variables.get('response_time_threshold') || 5000,",
					"    platform: 'trustpilot'",
					"};",
					"pm.variables.set('_config', JSON.stringify(CONFIG));",
					"",
					"// Skip request if required TrustPilot credentials are not configured",
					"const apiKey = pm.variables.get('trustpilot_api_key');",
					"const apiSecret = pm.variables.get('trustpilot_api_secret');",
					"",
					"const hasApiKey = apiKey && apiKey.trim() !== '' && !apiKey.startsWith('xxxx');",
					"const hasApiSecret = apiSecret && apiSecret.trim() !== '' && !apiSecret.startsWith('xxxx');",
					"",
					"if (!hasApiKey || !hasApiSecret) {",
					"    console.log('Skipping: TrustPilot credentials not configured');",
					"    console.log('   Set trustpilot_api_key and trustpilot_api_secret to run this test');",
					"    pm.execution.skipRequest();",
					"}",
					"",
					"// Set timestamp for request tracking",
					"pm.environment.set('request_timestamp', new Date().toISOString());"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// ============================================",
					"// SHARED TEST UTILITIES",
					"// ============================================",
					"",
					"const CONFIG = JSON.parse(pm.variables.get('_config') || '{\"responseTimeThreshold\": 5000}');",
					"",
					"const TestHelpers = {",
					"    expectStatus: function(expected = 200) {",
					"        pm.test(`Status code is ${expected}`, function() {",
					"            pm.response.to.have.status(expected);",
					"        });",
					"    },",
					"    expectStatusOneOf: function(codes = [200]) {",
					"        pm.test(`Status code is one of [${codes.join(', ')}]`, function() {",
					"            pm.expect(pm.response.code).to.be.oneOf(codes);",
					"        });",
					"    },",
					"    expectAcceptableResponseTime: function(threshold = CONFIG.responseTimeThreshold) {",
					"        pm.test(`Response time is below ${threshold}ms`, function() {",
					"            pm.expect(pm.response.responseTime).to.be.below(threshold);",
					"        });",
					"    },",
					"    expectJson: function() {",
					"        pm.test('Response is valid JSON', function() {",
					"            pm.response.to.be.json;",
					"        });",
					"    },",
					"    runStandardTests: function(expectedStatus = 200) {",
					"        this.expectStatus(expectedStatus);",
					"        this.expectAcceptableResponseTime();",
					"        this.expectJson();",
					"    }",
					"};",
					"// TestHelpers are now available for use in request-level test scripts"
				]
			}
		}
	],
	"variable": [
		{
			"key": "response_time_threshold",
			"value": "5000",
			"type": "default",
			"description": "Maximum acceptable response time in milliseconds"
		},
		{
			"key": "trustpilot_host",
			"value": "https://api.trustpilot.com/",
			"type": "default",
			"description": "API base URL"
		},
		{
			"key": "trustpilot_api_key",
			"value": "",
			"type": "secret",
			"description": "API key (Basic Auth username)"
		},
		{
			"key": "trustpilot_api_secret",
			"value": "",
			"type": "secret",
			"description": "API secret (Basic Auth password)"
		},
		{
			"key": "trustpilot_username",
			"value": "",
			"type": "default",
			"description": "TrustPilot account email"
		},
		{
			"key": "trustpilot_password",
			"value": "",
			"type": "secret",
			"description": "TrustPilot account password"
		},
		{
			"key": "trustpilot_business_unit_id",
			"value": "",
			"type": "default",
			"description": "Business Unit ID"
		},
		{
			"key": "trustpilot_access_token",
			"value": "",
			"type": "secret",
			"description": "OAuth token (from Auth Call)"
		}
	]
}